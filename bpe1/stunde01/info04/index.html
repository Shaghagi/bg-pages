<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Relative Adressierung in Excel ‚Äì Mini-Simulation</title>
  </head>
  <body style="margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; background: #f6f8fa; color:#0f172a;">
    <!-- Wrapper -->
    <div style="display:flex; justify-content:center; align-items:flex-start; min-height:100vh; padding:32px; box-sizing:border-box;">
      <!-- Card -->
      <div style="width: min(920px, 100%); background:white; border-radius:16px; box-shadow: 0 10px 30px rgba(2,6,23,0.08); padding:28px; box-sizing:border-box;">
        <h1 style="margin:0 0 12px; text-align:center; font-size:28px;">Relative Adressierung in Excel</h1>
        
        <!-- Text√ºbernahme (kompakt) -->
        <div style="margin: 6px auto 20px; max-width: 820px; line-height:1.5;">
          <p style="margin:0 0 10px;">
		<strong>Liebe Sch√ºlerin, lieber Sch√ºler</strong>,
		<br> bitte klicke nacheinander zuerst auf die Zelle <strong>D3</strong> und dann auf die Zelle <strong>D4</strong>. 
		<br><strong>Achte dabei</strong> genau darauf, wie sich die <span style="color: blue; font-weight: bold;">blaue</span> und 
		<span style="color: red; font-weight: bold;">rote</span> Umrandung der Zellen verschieben. 
		</p>
        </div>

        <!-- Formel-Leiste -->
        <div style="display:flex; align-items:center; gap:10px; border:1px solid #e2e8f0; border-radius:10px; padding:10px 12px; margin:0 auto 16px; max-width:820px; background:#fafbfc;">
          <div style="font-weight:600;">fx</div>
          <div id="formulaBar" style="white-space:nowrap; overflow:auto; font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;">
            <span id="fb-prefix" style="opacity:.75;">=</span>
            <span id="fb-part1" style="color:#1f6feb; font-weight:600;">B2</span>
            <span style="opacity:.75;">*</span>
            <span id="fb-part2" style="color:#d73a49; font-weight:600;">C2</span>
            <span id="fb-result" style="margin-left:12px; opacity:.7;"></span>
          </div>
        </div>

        <!-- Tabelle (Excel-√§hnlich) -->
        <div style="display:flex; justify-content:center;">
          <table id="sheet" style="border-collapse:separate; border-spacing:0; box-shadow:0 1px 0 #e2e8f0 inset;">
            <!-- Spaltenbuchstaben -->
            <tr>
              <th style="width:44px; background:#f3f4f6; border:1px solid #e5e7eb; text-align:center; padding:8px;">&nbsp;</th>
              <th style="min-width:150px; background:#f3f4f6; border:1px solid #e5e7eb; text-align:center; padding:8px;">A</th>
              <th style="min-width:140px; background:#f3f4f6; border:1px solid #e5e7eb; text-align:center; padding:8px;">B</th>
              <th style="min-width:140px; background:#f3f4f6; border:1px solid #e5e7eb; text-align:center; padding:8px;">C</th>
              <th style="min-width:160px; background:#f3f4f6; border:1px solid #e5e7eb; text-align:center; padding:8px;">D</th>
            </tr>
            <!-- Kopfzeile -->
            <tr>
              <th style="background:#f8fafc; border:1px solid #e5e7eb; text-align:center; padding:8px;">1</th>
              <th style="border:1px solid #e5e7eb; padding:8px; background:#ffffff;">Produkt</th>
              <th style="border:1px solid #e5e7eb; padding:8px; background:#ffffff;">Preis (‚Ç¨)</th>
              <th style="border:1px solid #e5e7eb; padding:8px; background:#ffffff;">Anzahl</th>
              <th style="border:1px solid #e5e7eb; padding:8px; background:#ffffff;">Gesamt (‚Ç¨)</th>
            </tr>
            <!-- Zeile 2 -->
            <tr>
              <th style="background:#f8fafc; border:1px solid #e5e7eb; text-align:center; padding:8px;">2</th>
              <td id="A2" style="border:1px solid #e5e7eb; padding:8px;">Apfel</td>
              <td id="B2" style="border:1px solid #e5e7eb; padding:8px;" contenteditable="true">2</td>
              <td id="C2" style="border:1px solid #e5e7eb; padding:8px;" contenteditable="true">3</td>
              <td id="D2" data-row="2" style="border:2px solid #d1d5db; padding:8px; cursor:pointer; background:#fcfcff; font-family: ui-monospace, Menlo, Consolas, monospace;">=B2*C2</td>
            </tr>
            <!-- Zeile 3 -->
            <tr>
              <th style="background:#f8fafc; border:1px solid #e5e7eb; text-align:center; padding:8px;">3</th>
              <td id="A3" style="border:1px solid #e5e7eb; padding:8px;">Birne</td>
              <td id="B3" style="border:1px solid #e5e7eb; padding:8px;" contenteditable="true">4</td>
              <td id="C3" style="border:1px solid #e5e7eb; padding:8px;" contenteditable="true">2</td>
              <td id="D3" data-row="3" style="border:2px solid #d1d5db; padding:8px; cursor:pointer; background:#fcfcff; font-family: ui-monospace, Menlo, Consolas, monospace;">=B3*C3</td>
            </tr>
            <!-- Zeile 4 -->
            <tr>
              <th style="background:#f8fafc; border:1px solid #e5e7eb; text-align:center; padding:8px;">4</th>
              <td id="A4" style="border:1px solid #e5e7eb; padding:8px;">Kirsche</td>
              <td id="B4" style="border:1px solid #e5e7eb; padding:8px;" contenteditable="true">5</td>
              <td id="C4" style="border:1px solid #e5e7eb; padding:8px;" contenteditable="true">6</td>
              <td id="D4" data-row="4" style="border:2px solid #d1d5db; padding:8px; cursor:pointer; background:#fcfcff; font-family: ui-monospace, Menlo, Consolas, monospace;">=B4*C4</td>
            </tr>
          </table>
        </div>

        <!-- Controls -->
        <div style="display:flex; gap:12px; justify-content:center; align-items:center; margin-top:18px; flex-wrap:wrap;">
          <button id="selectD2" style="padding:10px 14px; border-radius:12px; border:1px solid #e5e7eb; background:#0ea5e9; color:white; font-weight:600; box-shadow:0 6px 14px rgba(14,165,233,0.25); cursor:pointer;">D2 ausw√§hlen</button>
          <button id="fillDown" style="padding:10px 14px; border-radius:12px; border:1px solid #e5e7eb; background:#10b981; color:white; font-weight:600; box-shadow:0 6px 14px rgba(16,185,129,0.25); cursor:pointer;">Formel aus D2 nach unten kopieren</button>
          <button id="clearHL" style="padding:10px 14px; border-radius:12px; border:1px solid #e5e7eb; background:white; color:#111827; font-weight:600; box-shadow:0 6px 14px rgba(2,6,23,0.05); cursor:pointer;">Markierungen zur√ºcksetzen</button>
        </div>

        <!-- Text√ºbernahme (kompakt) -->
        <div style="margin: 6px auto 20px; max-width: 820px; line-height:1.5;">
          <h2>Was passiert hier?</h2>
		  <ul> 
		  <li>In D2 steht die Formel =B2*C2.</li> 
		  <li>Kopiert man die Formel nach unten (z. B. in D3), wird sie automatisch angepasst zu =B3*C3.</li> 
		  <li>Kopiert man sie nach D4, wird daraus =B4*C4.</li> 
		  </ul>
		  <p style="margin:0 0 10px;">
		 üëâ Das nennt man <span style="color: blue; font-weight:bold;">relative</span> <span style="font-weight:bold;">Adressierung</span>, 
		 weil Excel sich <span style="color: blue;">relativ</span> zur Position der <strong>Formel</strong> merkt, wo die Werte stehen:
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‚óæÔ∏è ‚Äû2 Zellen links und 0 Zellen nach oben‚Äú (Preis)
			<br>

			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‚óæÔ∏è ‚Äû1 Zelle links und 0 Zellen nach oben‚Äú (Anzahl)
			<br>

			Egal, in welcher Zeile du bist ‚Äì die Abst√§nde bleiben gleich.
		  </p>
        </div>



        <hr style="margin:28px 0; border:none; border-top:1px solid #e5e7eb;" />

        <!-- NEU: Beispiel mit versetzten Spalten & Zeilen (horizontale und vertikale Offsets) -->
        <h2 style="margin:0 0 10px; font-size:22px; text-align:left;">Beispiel 2 ‚Äì Versetzte Bez√ºge: eine Zeile hoch & zwei Spalten links</h2>
        <p style="margin:0 auto 10px; text-align:center; max-width:820px; color:#475569;">Formel in <strong>E3</strong>: <code>=C2 + B3 * D2</code> &nbsp;‚Üí Offsets relativ zu E3: <em>C2</em> (‚àí1 Zeile, ‚àí2 Spalten), <em>B3</em> (0 Zeilen, ‚àí3 Spalten), <em>D2</em> (‚àí1 Zeile, ‚àí1 Spalte). Beim Kopieren nach unten wird daraus in E4: <code>=C3 + B4 * D3</code>.</p>

        <!-- Formel-Leiste Offsets -->
        <div style="display:flex; align-items:center; gap:10px; border:1px solid #e2e8f0; border-radius:10px; padding:10px 12px; margin:0 auto 16px; max-width:820px; background:#fafbfc;">
          <div style="font-weight:600;">fx</div>
          <div id="formulaBarOFF" style="white-space:nowrap; overflow:auto; font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;">
            <span>=</span>
            <span id="fbO-c" style="color:#1f6feb; font-weight:600;">C2</span>
            <span> + </span>
            <span id="fbO-b" style="color:#d73a49; font-weight:600;">B3</span>
            <span> * </span>
            <span id="fbO-d" style="color:#7c3aed; font-weight:600;">D2</span>
            <span id="fbO-result" style="margin-left:12px; opacity:.7;"></span>
          </div>
        </div>

        <!-- Tabelle Offsets -->
        <div style="display:flex; justify-content:center;">
          <table id="sheetOFF" style="border-collapse:separate; border-spacing:0; box-shadow:0 1px 0 #e2e8f0 inset;">
            <tr>
              <th style="width:44px; background:#f3f4f6; border:1px solid #e5e7eb; text-align:center; padding:8px;">&nbsp;</th>
              <th style="min-width:110px; background:#f3f4f6; border:1px solid #e5e7eb; text-align:center; padding:8px;">A</th>
              <th style="min-width:110px; background:#f3f4f6; border:1px solid #e5e7eb; text-align:center; padding:8px;">B</th>
              <th style="min-width:110px; background:#f3f4f6; border:1px solid #e5e7eb; text-align:center; padding:8px;">C</th>
              <th style="min-width:110px; background:#f3f4f6; border:1px solid #e5e7eb; text-align:center; padding:8px;">D</th>
              <th style="min-width:140px; background:#f3f4f6; border:1px solid #e5e7eb; text-align:center; padding:8px;">E</th>
            </tr>
            <tr>
              <th style="background:#f8fafc; border:1px solid #e5e7eb; text-align:center; padding:8px;">1</th>
              <th style="border:1px solid #e5e7eb; padding:8px; background:#ffffff;">Bezeichnung</th>
              <th style="border:1px solid #e5e7eb; padding:8px; background:#ffffff;">B (Faktor1)</th>
              <th style="border:1px solid #e5e7eb; padding:8px; background:#ffffff;">C (Basis oben)</th>
              <th style="border:1px solid #e5e7eb; padding:8px; background:#ffffff;">D (Faktor2 oben)</th>
              <th style="border:1px solid #e5e7eb; padding:8px; background:#ffffff;">E (Ergebnis)</th>
            </tr>
            <tr>
              <th style="background:#f8fafc; border:1px solid #e5e7eb; text-align:center; padding:8px;">2</th>
              <td style="border:1px solid #e5e7eb; padding:8px;">Vorzeile</td>
              <td id="OB2" style="border:1px solid #e5e7eb; padding:8px;" contenteditable="true">1,5</td>
              <td id="OC2" style="border:1px solid #e5e7eb; padding:8px;" contenteditable="true">10</td>
              <td id="OD2" style="border:1px solid #e5e7eb; padding:8px;" contenteditable="true">2</td>
              <td style="border:1px solid #e5e7eb; padding:8px; color:#94a3b8;">‚Äì</td>
            </tr>
            <tr>
              <th style="background:#f8fafc; border:1px solid #e5e7eb; text-align:center; padding:8px;">3</th>
              <td style="border:1px solid #e5e7eb; padding:8px;">Aktuell 1</td>
              <td id="OB3" style="border:1px solid #e5e7eb; padding:8px;" contenteditable="true">2</td>
              <td id="OC3" style="border:1px solid #e5e7eb; padding:8px;" contenteditable="true">20</td>
              <td id="OD3" style="border:1px solid #e5e7eb; padding:8px;" contenteditable="true">3</td>
              <td id="OE3" data-row="3" style="border:2px solid #d1d5db; padding:8px; cursor:pointer; background:#fcfcff; font-family: ui-monospace, Menlo, Consolas, monospace;">=C2 + B3 * D2</td>
            </tr>
            <tr>
              <th style="background:#f8fafc; border:1px solid #e5e7eb; text-align:center; padding:8px;">4</th>
              <td style="border:1px solid #e5e7eb; padding:8px;">Aktuell 2</td>
              <td id="OB4" style="border:1px solid #e5e7eb; padding:8px;" contenteditable="true">4</td>
              <td id="OC4" style="border:1px solid #e5e7eb; padding:8px;" contenteditable="true">5</td>
              <td id="OD4" style="border:1px solid #e5e7eb; padding:8px;" contenteditable="true">1</td>
              <td id="OE4" data-row="4" style="border:2px solid #d1d5db; padding:8px; cursor:pointer; background:#fcfcff; font-family: ui-monospace, Menlo, Consolas, monospace;">=C3 + B4 * D3</td>
            </tr>
          </table>
        </div>
        <p style="margin:10px auto 0; text-align:center; max-width:780px; font-size:14px; color:#475569;">Doppelklick auf <strong>E3</strong> bzw. <strong>E4</strong> zeigt drei farbige Bez√ºge mit unterschiedlichen Offsets. Kopiere die Formel von E3 nach E4, um die <em>relative</em> Verschiebung zu sehen.</p>
		
		<hr style="margin:28px 0; border:none; border-top:1px solid #e5e7eb;" />
		
		<h2 style="color:blue;margin:0 0 10px; font-size:22px; text-align:left;">
			Wie kann ich Excel sagen, dass er beim Verschieben/Kopieren der Formel die relativen Zellen <strong style="color:red;">nicht</strong> verschieben soll?
		</h2>
	  
	  	    <!-- NEU: Absolute/ gemischte Adressierung -->
        <div style="margin: 16px auto 20px; max-width: 820px; line-height:1.6; background:#f8fafc; border:1px solid #e5e7eb; border-radius:12px; padding:16px;">
          <h2 style="margin:0 0 8px; font-size:22px;"><span style="color:hotpink;">Absolute</span> 
		  und <span style="color:orange;">gemischt absolute</span> Adressierung mit <strong style="color:red;">$</strong></h2>
          <p style="margin:0 0 10px;">
            Manchmal soll beim Kopieren <em>ein bestimmter Bezug nicht mitwandern</em>
			‚Äì z.&nbsp;B. ein fester Steuersatz in <strong>B1</strong> oder ein fixer Wechselkurs in <strong>F2</strong>. 
			Daf√ºr setzt man ein Dollarzeichen <strong style="color:red;">$</strong> <strong>vor</strong> Spaltenbuchstaben und/oder Zeilennummer,
			welche fixiert werden soll.
			<br>
			<strong>Das Dollarzeichen verhindert</strong>, dass sich beim Kopieren/Verschieben der Formel Spaltenbuchstabe und/oder Zeilennummer √§ndern.
          </p>
		  
		<div style="margin:10px 0;">
		  <table style="border-collapse:separate; border-spacing:0; width:100%; max-width:820px;">
			<thead>
			  <tr>
				<th style="text-align:left; padding:10px; border:1px dashed #cbd5e1; background:#f8fafc; font-weight:700;">Form</th>
				<th style="text-align:left; padding:10px; border:1px dashed #cbd5e1; background:#f8fafc; font-weight:700;">Auswirkung beim Kopieren</th>
			  </tr>
			</thead>
			<tbody>
			  <tr>
				<td style="padding:10px; border:1px dashed #cbd5e1;"><code>A1</code> ‚Äì alles relativ</td>
				<td style="padding:10px; border:1px dashed #cbd5e1;"><em>wandert mit</em> (wie oben gezeigt)</td>
			  </tr>
			  <tr style="background-color: rgba(255, 165, 0, 0.4);">
				<td style="padding:10px; border:1px dashed #cbd5e1;"><code>$A1</code> ‚Äì Spalte A fix, Zeile relativ</td>
				<td style="padding:10px; border:1px dashed #cbd5e1;">Spalte bleibt A, Zeile passt sich an (gut bei Festwerten in einer Spalte)</td>
			  </tr>
			  <tr style="background-color: rgba(255, 165, 0, 0.4);">
				<td style="padding:10px; border:1px dashed #cbd5e1;"><code>A$1</code> ‚Äì Zeile 1 fix, Spalte relativ</td>
				<td style="padding:10px; border:1px dashed #cbd5e1;">Zeile bleibt 1, Spalte passt sich an (gut bei Kopfzeilenwerten)</td>
			  </tr>
			  <tr style="background-color: rgba(255, 105, 180, 0.4);">
				<td style="padding:10px; border:1px dashed #cbd5e1;"><code>$A$1</code> ‚Äì Spalte &amp; Zeile fix (voll absolut)</td>
				<td style="padding:10px; border:1px dashed #cbd5e1;">bleibt exakt dieselbe Zelle (gut f√ºr Konstanten wie MwSt., Kurs, Rabatt)</td>
			  </tr>
			</tbody>
		  </table>
		</div>

          <div style="background:#ecfeff; border:1px solid #bae6fd; padding:10px; border-radius:10px; font-size:20px; margin:20px 0;">
            <strong>So stellst du es in Excel ein:</strong> Markiere den Bezug in der Bearbeitungsleiste und dr√ºcke <strong>F4</strong>, um zwischen <code>A1 ‚Üí $A1 ‚Üí A$1 ‚Üí $A$1</code> zu wechseln. 
          </div>

        </div>
        <!-- Ende NEU -->
	  
	  </div>
	  

	  
    </div>



    <!-- JavaScript (inline) -->
    <script>
      (function(){
        const blue = '#1f6feb';
        const red  = '#d73a49';
        const purple = '#7c3aed';
        const green = '#059669';
        const gray = '#d1d5db';

        let activeRow = 2; // Start: D2

        const fbPart1 = document.getElementById('fb-part1');
        const fbPart2 = document.getElementById('fb-part2');
        const fbResult = document.getElementById('fb-result');

        function parseNumber(txt){
          if (typeof txt !== 'string') txt = String(txt ?? '');
          txt = txt.replace(/\u00A0/g, ' ').trim(); // nbsp
          // deutsch: Komma als Dezimaltrennzeichen erlauben
          txt = txt.replace(',', '.');
          const n = parseFloat(txt);
          return isFinite(n) ? n : 0;
        }

        function money(n){
          return n.toLocaleString('de-DE', {minimumFractionDigits: 2, maximumFractionDigits: 2});
        }

        function cell(id){ return document.getElementById(id); }

        function computeRow(row){
          const price = parseNumber(cell('B'+row).innerText);
          const qty   = parseNumber(cell('C'+row).innerText);
          return price * qty;
        }

        function updateFormulaBar(row){
          fbPart1.textContent = 'B' + row;
          fbPart2.textContent = 'C' + row;
          const value = computeRow(row);
          fbResult.textContent = '‚Üí ' + money(value) + ' ‚Ç¨';
        }

        function clearHighlights(){
          // remove outlines/backgrounds on Bx, Cx, Dx
          [2,3,4].forEach(r => {
            ['B','C','D'].forEach(col => {
              const el = cell(col + r);
              el.style.outline = '';
              el.style.boxShadow = '';
              el.style.background = (col==='D') ? '#fcfcff' : '#ffffff';
              el.style.borderColor = '#d1d5db';
            });
          });
        }

        function highlightRow(row){
          clearHighlights();
          const b = cell('B'+row);
          const c = cell('C'+row);
          const d = cell('D'+row);
          b.style.outline = '3px solid ' + blue;
          b.style.background = '#eef5ff';
          c.style.outline = '3px solid ' + red;
          c.style.background = '#ffeef0';
          d.style.outline = '3px solid ' + green;
          d.style.background = '#ecfdf5';
          d.style.borderColor = green;
        }

        function selectRow(row){
          activeRow = row;
          updateFormulaBar(row);
          highlightRow(row);
        }

        // Event: Doppelklick auf D-Zellen zeigt farbige K√§stchen (Referenzen)
        [2,3,4].forEach(r => {
          const d = cell('D'+r);
          d.addEventListener('dblclick', () => selectRow(r));
          d.addEventListener('click', () => selectRow(r));
        });

        // Buttons
        document.getElementById('selectD2').addEventListener('click', () => selectRow(2));
        document.getElementById('clearHL').addEventListener('click', () => { clearHighlights(); updateFormulaBar(activeRow); });

        // Autofill: kopiert Formel von D2 nach unten (zeigt relative Anpassung optisch in der Leiste)
        document.getElementById('fillDown').addEventListener('click', () => {
          // In dieser Demo sind die Formeln bereits als =B3*C3 usw. gesetzt.
          // Wir triggern hier lediglich die visuelle Auswahl nacheinander.
          [3,4].forEach((r, idx) => {
            setTimeout(() => selectRow(r), 250 * (idx+1));
          });
          setTimeout(() => selectRow(2), 900);
        });

        // Live-Neuberechnung, wenn Preis/Anzahl editiert werden
        [2,3,4].forEach(r => {
          ['B','C'].forEach(col => {
            const el = cell(col + r);
            el.addEventListener('input', () => {
              if (r === activeRow) updateFormulaBar(r);
            });
            el.addEventListener('blur', () => {
              if (r === activeRow) updateFormulaBar(r);
            });
          });
        });

        // Initial
        selectRow(2);

        // =========================
        // NEU: Offsets-Demo (E3/E4)
        // =========================
        const fbOc = document.getElementById('fbO-c');
        const fbOb = document.getElementById('fbO-b');
        const fbOd = document.getElementById('fbO-d');
        const fbOres = document.getElementById('fbO-result');

        function parseN(id){ return parseNumber(document.getElementById(id).innerText); }

        function computeOFF(row){
          // E[row] = C[row-1] + B[row] * D[row-1]
          const c_up = parseN('OC' + (row-1));
          const b_now = parseN('OB' + row);
          const d_up = parseN('OD' + (row-1));
          return c_up + b_now * d_up;
        }

        function updateOFF(row){
          fbOc.textContent = 'C' + (row-1);
          fbOb.textContent = 'B' + row;
          fbOd.textContent = 'D' + (row-1);
          fbOres.textContent = '‚Üí ' + money(computeOFF(row)) + ' (Einheiten)';
        }

        function clearOFF(){
          [3,4].forEach(r => {
            ['OB'+r, 'OC'+(r-1), 'OD'+(r-1), 'OE'+r].forEach(id => {
              const el = document.getElementById(id);
              if(!el) return;
              el.style.outline='';
              el.style.background = id.startsWith('OE') ? '#fcfcff' : '#ffffff';
              el.style.borderColor = '#d1d5db';
            });
          });
        }

        function highlightOFF(row){
          clearOFF();
          const c_up = document.getElementById('OC' + (row-1));
          const b_now = document.getElementById('OB' + row);
          const d_up = document.getElementById('OD' + (row-1));
          const e = document.getElementById('OE' + row);
          c_up.style.outline = '3px solid ' + blue; c_up.style.background = '#eef5ff';
          b_now.style.outline = '3px solid ' + red;  b_now.style.background = '#ffeef0';
          d_up.style.outline = '3px solid ' + purple; d_up.style.background = '#f5f0ff';
          e.style.outline = '3px solid ' + green; e.style.background = '#ecfdf5'; e.style.borderColor = green;
        }

        [3,4].forEach(r => {
          const e = document.getElementById('OE' + r);
          e.addEventListener('click', () => { updateOFF(r); highlightOFF(r); });
          e.addEventListener('dblclick', () => { updateOFF(r); highlightOFF(r); });
          ['OB','OC','OD'].forEach(prefix => {
            const el = document.getElementById(prefix + r) || document.getElementById(prefix + (r-1));
            if(el){ el.addEventListener('input', () => { updateOFF(r); }); }
          });
        });

        // Startzustand f√ºr Offsets: zeige E3
        updateOFF(3);
        highlightOFF(3);
      })();
    </script>
  </body>
</html>